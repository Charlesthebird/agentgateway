{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "oneOf": [
    {
      "type": "object",
      "properties": {
        "passthrough": {
          "type": "object",
          "additionalProperties": false
        }
      },
      "required": [
        "passthrough"
      ],
      "title": "Passthrough"
    },
    {
      "type": "object",
      "properties": {
        "key": {
          "$ref": "#/$defs/FileOrInline"
        }
      },
      "required": [
        "key"
      ],
      "title": "Key"
    },
    {
      "type": "object",
      "properties": {
        "gcp": {
          "$ref": "#/$defs/GcpAuth"
        }
      },
      "required": [
        "gcp"
      ],
      "title": "Gcp"
    },
    {
      "type": "object",
      "properties": {
        "aws": {
          "$ref": "#/$defs/AwsAuth"
        }
      },
      "required": [
        "aws"
      ],
      "title": "Aws"
    },
    {
      "type": "object",
      "properties": {
        "azure": {
          "$ref": "#/$defs/AzureAuth"
        }
      },
      "required": [
        "azure"
      ],
      "title": "Azure"
    }
  ],
  "title": "Backend Auth",
  "$defs": {
    "FileOrInline": {
      "anyOf": [
        {
          "type": "object",
          "properties": {
            "file": {
              "type": "string"
            }
          },
          "required": [
            "file"
          ],
          "title": "File"
        },
        {
          "type": "string"
        }
      ],
      "title": "File Or Inline"
    },
    "GcpAuth": {
      "anyOf": [
        {
          "description": "Fetch an id token",
          "type": "object",
          "properties": {
            "type": {
              "$ref": "#/$defs/IdToken"
            },
            "audience": {
              "description": "Audience for the token. If not set, the destination host will be used.",
              "type": [
                "string",
                "null"
              ]
            }
          },
          "required": [
            "type"
          ],
          "title": "Type"
        },
        {
          "description": "Fetch an access token",
          "type": "object",
          "properties": {
            "type": {
              "anyOf": [
                {
                  "$ref": "#/$defs/AccessToken"
                },
                {
                  "type": "null"
                }
              ],
              "default": null
            }
          },
          "title": "Type"
        }
      ],
      "title": "Gcp Auth"
    },
    "IdToken": {
      "type": "string",
      "const": "idToken",
      "title": "Id Token"
    },
    "AccessToken": {
      "type": "string",
      "const": "accessToken",
      "title": "Access Token"
    },
    "AwsAuth": {
      "anyOf": [
        {
          "description": "Use explicit AWS credentials",
          "type": "object",
          "properties": {
            "accessKeyId": {
              "type": "string"
            },
            "secretAccessKey": {
              "type": "string"
            },
            "region": {
              "type": [
                "string",
                "null"
              ]
            },
            "sessionToken": {
              "type": [
                "string",
                "null"
              ]
            }
          },
          "required": [
            "accessKeyId",
            "secretAccessKey"
          ],
          "title": "Access Key Id"
        },
        {
          "description": "Use implicit AWS authentication (environment variables, IAM roles, etc.)",
          "type": "object"
        }
      ],
      "title": "Aws Auth"
    },
    "AzureAuth": {
      "oneOf": [
        {
          "description": "Use explicit Azure credentials",
          "type": "object",
          "properties": {
            "explicitConfig": {
              "type": "object",
              "oneOf": [
                {
                  "type": "object",
                  "properties": {
                    "clientSecret": {
                      "type": "object",
                      "properties": {
                        "tenant_id": {
                          "type": "string"
                        },
                        "client_id": {
                          "type": "string"
                        },
                        "client_secret": {
                          "type": "string"
                        }
                      },
                      "additionalProperties": false,
                      "required": [
                        "tenant_id",
                        "client_id",
                        "client_secret"
                      ]
                    }
                  },
                  "required": [
                    "clientSecret"
                  ]
                },
                {
                  "type": "object",
                  "properties": {
                    "managedIdentity": {
                      "type": "object",
                      "properties": {
                        "userAssignedIdentity": {
                          "anyOf": [
                            {
                              "$ref": "#/$defs/AzureUserAssignedIdentity"
                            },
                            {
                              "type": "null"
                            }
                          ]
                        }
                      },
                      "additionalProperties": false
                    }
                  },
                  "required": [
                    "managedIdentity"
                  ]
                },
                {
                  "type": "object",
                  "properties": {
                    "workloadIdentity": {
                      "type": "object",
                      "additionalProperties": false
                    }
                  },
                  "required": [
                    "workloadIdentity"
                  ]
                }
              ]
            }
          },
          "required": [
            "explicitConfig"
          ],
          "title": "Explicit Config"
        },
        {
          "description": "Use implicit Azure auth. Note that this is for developer use-cases only!",
          "type": "object",
          "properties": {
            "developerImplicit": {
              "type": "object",
              "additionalProperties": false
            }
          },
          "required": [
            "developerImplicit"
          ],
          "title": "Developer Implicit"
        }
      ],
      "title": "Azure Auth"
    },
    "AzureUserAssignedIdentity": {
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "clientId": {
              "type": "string"
            }
          },
          "required": [
            "clientId"
          ],
          "title": "Client Id"
        },
        {
          "type": "object",
          "properties": {
            "objectId": {
              "type": "string"
            }
          },
          "required": [
            "objectId"
          ],
          "title": "Object Id"
        },
        {
          "type": "object",
          "properties": {
            "resourceId": {
              "type": "string"
            }
          },
          "required": [
            "resourceId"
          ],
          "title": "Resource Id"
        }
      ],
      "title": "Azure User Assigned Identity"
    }
  },
  "description": "Backend Auth connection"
}