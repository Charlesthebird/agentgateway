{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "type": "object",
  "properties": {
    "http": {
      "description": "Settings for handling incoming HTTP requests.",
      "anyOf": [
        {
          "$ref": "#/$defs/HTTP2",
          "title": "HTTP2"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Http"
    },
    "tls": {
      "description": "Settings for handling incoming TLS connections.",
      "anyOf": [
        {
          "$ref": "#/$defs/TLS",
          "title": "TLS"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Tls"
    },
    "tcp": {
      "description": "Settings for handling incoming TCP connections.",
      "anyOf": [
        {
          "$ref": "#/$defs/TCP2",
          "title": "TCP2"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Tcp"
    },
    "accessLog": {
      "description": "Settings for request access logs.",
      "anyOf": [
        {
          "$ref": "#/$defs/LoggingPolicy",
          "title": "Logging Policy"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Access Log"
    },
    "tracing": {
      "anyOf": [
        {
          "$ref": "#/$defs/TracingConfig",
          "title": "Tracing Config"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Tracing"
    }
  },
  "additionalProperties": false,
  "title": "Local Frontend Policies",
  "$defs": {
    "HTTP2": {
      "type": "object",
      "properties": {
        "maxBufferSize": {
          "type": "integer",
          "format": "uint",
          "minimum": 0,
          "default": 2097152,
          "title": "Max Buffer Size"
        },
        "http1MaxHeaders": {
          "description": "The maximum number of headers allowed in a request. Changing this value results in a performance\ndegradation, even if set to a lower value than the default (100)",
          "type": [
            "integer",
            "null"
          ],
          "format": "uint",
          "minimum": 0,
          "default": null,
          "title": "Http1Max Headers"
        },
        "http1IdleTimeout": {
          "type": "string",
          "default": "10m0s",
          "title": "Http1Idle Timeout"
        },
        "http2WindowSize": {
          "type": [
            "integer",
            "null"
          ],
          "format": "uint32",
          "minimum": 0,
          "default": null,
          "title": "Http2Window Size"
        },
        "http2ConnectionWindowSize": {
          "type": [
            "integer",
            "null"
          ],
          "format": "uint32",
          "minimum": 0,
          "default": null,
          "title": "Http2Connection Window Size"
        },
        "http2FrameSize": {
          "type": [
            "integer",
            "null"
          ],
          "format": "uint32",
          "minimum": 0,
          "default": null,
          "title": "Http2Frame Size"
        },
        "http2KeepaliveInterval": {
          "type": [
            "string",
            "null"
          ],
          "default": null,
          "title": "Http2Keepalive Interval"
        },
        "http2KeepaliveTimeout": {
          "type": [
            "string",
            "null"
          ],
          "default": null,
          "title": "Http2Keepalive Timeout"
        }
      },
      "additionalProperties": false,
      "title": "HTTP2"
    },
    "TLS": {
      "type": "object",
      "properties": {
        "handshakeTimeout": {
          "type": "string",
          "default": "15s",
          "title": "Handshake Timeout"
        },
        "alpn": {
          "type": [
            "array",
            "null"
          ],
          "items": {
            "type": "array",
            "items": {
              "type": "integer",
              "format": "uint8",
              "minimum": 0,
              "maximum": 255
            }
          },
          "default": null,
          "title": "Alpn"
        },
        "minVersion": {
          "anyOf": [
            {
              "$ref": "#/$defs/TLSVersion",
              "title": "TLS Version"
            },
            {
              "type": "null"
            }
          ],
          "title": "Min Version"
        },
        "maxVersion": {
          "anyOf": [
            {
              "$ref": "#/$defs/TLSVersion",
              "title": "TLS Version"
            },
            {
              "type": "null"
            }
          ],
          "title": "Max Version"
        },
        "cipherSuites": {
          "type": [
            "array",
            "null"
          ],
          "items": {
            "type": "string"
          },
          "title": "Cipher Suites"
        }
      },
      "additionalProperties": false,
      "title": "TLS"
    },
    "TLSVersion": {
      "type": "string",
      "enum": [
        "TLS_V1_0",
        "TLS_V1_1",
        "TLS_V1_2",
        "TLS_V1_3"
      ],
      "title": "TLS Version"
    },
    "TCP2": {
      "type": "object",
      "properties": {
        "keepalives": {
          "$ref": "#/$defs/KeepaliveConfig",
          "title": "Keepalives"
        }
      },
      "additionalProperties": false,
      "required": [
        "keepalives"
      ],
      "title": "TCP2"
    },
    "KeepaliveConfig": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": true,
          "title": "Enabled"
        },
        "time": {
          "type": "string",
          "default": "3m0s",
          "title": "Time"
        },
        "interval": {
          "type": "string",
          "default": "3m0s",
          "title": "Interval"
        },
        "retries": {
          "type": "integer",
          "format": "uint32",
          "minimum": 0,
          "default": 9,
          "title": "Retries"
        }
      },
      "additionalProperties": false,
      "title": "Keepalive Config"
    },
    "LoggingPolicy": {
      "type": "object",
      "properties": {
        "filter": {
          "anyOf": [
            {
              "$ref": "#/$defs/Expression",
              "title": "Expression"
            },
            {
              "type": "null"
            }
          ],
          "title": "Filter"
        },
        "add": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          },
          "title": "Add"
        },
        "remove": {
          "type": "array",
          "uniqueItems": true,
          "items": {
            "type": "string"
          },
          "title": "Remove"
        }
      },
      "additionalProperties": false,
      "title": "Logging Policy"
    },
    "Expression": {
      "type": "string",
      "title": "Expression"
    },
    "TracingConfig": {
      "description": "Configuration for dynamic tracing policy",
      "type": "object",
      "properties": {
        "attributes": {
          "description": "Span attributes to add, keyed by attribute name.",
          "$ref": "#/$defs/OrderedStringMap_Expression",
          "default": {},
          "title": "Attributes"
        },
        "resources": {
          "description": "Resource attributes to add to the tracer provider (OTel `Resource`).\nThis can be used to set things like `service.name` dynamically.",
          "$ref": "#/$defs/OrderedStringMap_Expression",
          "default": {},
          "title": "Resources"
        },
        "remove": {
          "description": "Attribute keys to remove from the emitted span attributes.\n\nThis is applied before `attributes` are evaluated/added, so it can be used to drop\ndefault attributes or avoid duplication.",
          "type": "array",
          "items": {
            "type": "string"
          },
          "default": [],
          "title": "Remove"
        },
        "randomSampling": {
          "description": "Optional per-policy override for random sampling. If set, overrides global config for\nrequests that use this frontend policy.",
          "anyOf": [
            {
              "$ref": "#/$defs/Expression",
              "title": "Expression"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Random Sampling"
        },
        "clientSampling": {
          "description": "Optional per-policy override for client sampling. If set, overrides global config for\nrequests that use this frontend policy.",
          "anyOf": [
            {
              "$ref": "#/$defs/Expression",
              "title": "Expression"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Client Sampling"
        },
        "path": {
          "type": "string",
          "default": "/v1/traces",
          "title": "Path"
        },
        "protocol": {
          "$ref": "#/$defs/TracingProtocol",
          "default": "http",
          "title": "Protocol"
        }
      },
      "oneOf": [
        {
          "type": "string",
          "enum": [
            "invalid"
          ],
          "title": "Option 1"
        },
        {
          "description": "Service reference. Service must be defined in the top level services list.",
          "type": "object",
          "properties": {
            "service": {
              "type": "object",
              "properties": {
                "name": {
                  "$ref": "#/$defs/NamespacedHostname"
                },
                "port": {
                  "type": "integer",
                  "format": "uint16",
                  "minimum": 0,
                  "maximum": 65535
                }
              },
              "additionalProperties": false,
              "required": [
                "name",
                "port"
              ]
            }
          },
          "required": [
            "service"
          ],
          "title": "Service"
        },
        {
          "description": "Hostname or IP address",
          "type": "object",
          "properties": {
            "host": {
              "type": "string",
              "description": "Format: host:port (e.g. \"example.com:8080\")"
            }
          },
          "required": [
            "host"
          ],
          "title": "Host"
        },
        {
          "type": "object",
          "properties": {
            "backend": {
              "description": "Explicit backend reference. Backend must be defined in the top level backends list",
              "type": "string"
            }
          },
          "required": [
            "backend"
          ],
          "title": "Backend"
        }
      ],
      "title": "Tracing Config"
    },
    "OrderedStringMap_Expression": {
      "type": "object",
      "additionalProperties": {
        "$ref": "#/$defs/Expression"
      },
      "title": "Ordered String Map_Expression"
    },
    "TracingProtocol": {
      "type": "string",
      "enum": [
        "http",
        "grpc"
      ],
      "title": "Tracing Protocol"
    },
    "NamespacedHostname": {
      "type": "string",
      "title": "Namespaced Hostname",
      "description": "Format: namespace/hostname (e.g. \"default/my-service\")",
      "pattern": "^[^/]+/[^/]+$"
    }
  },
  "description": "Local Frontend Policies"
}
