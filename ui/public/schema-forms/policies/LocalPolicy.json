{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "type": "object",
  "properties": {
    "name": {
      "$ref": "#/$defs/ResourceName",
      "title": "Name"
    },
    "target": {
      "$ref": "#/$defs/PolicyTarget",
      "title": "Target"
    },
    "phase": {
      "description": "phase defines at what level the policy runs at. Gateway policies run pre-routing, while\nRoute policies apply post-routing.\nOnly a subset of policies are eligible as Gateway policies.\nIn general, normal (route level) policies should be used, except you need the policy to influence\nrouting.",
      "$ref": "#/$defs/PolicyPhase",
      "default": "route",
      "title": "Phase"
    },
    "policy": {
      "$ref": "#/$defs/FilterOrPolicy",
      "title": "Policy"
    }
  },
  "additionalProperties": false,
  "required": [
    "name",
    "target",
    "policy"
  ],
  "title": "Local Policy",
  "$defs": {
    "ResourceName": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "title": "Name"
        },
        "namespace": {
          "type": "string",
          "title": "Namespace"
        }
      },
      "additionalProperties": false,
      "required": [
        "name",
        "namespace"
      ],
      "title": "Resource Name"
    },
    "PolicyTarget": {
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "gateway": {
              "$ref": "#/$defs/ListenerTarget"
            }
          },
          "required": [
            "gateway"
          ],
          "additionalProperties": false,
          "title": "Gateway"
        },
        {
          "type": "object",
          "properties": {
            "route": {
              "$ref": "#/$defs/RouteName"
            }
          },
          "required": [
            "route"
          ],
          "additionalProperties": false,
          "title": "Route"
        },
        {
          "type": "object",
          "properties": {
            "backend": {
              "$ref": "#/$defs/BackendTarget"
            }
          },
          "required": [
            "backend"
          ],
          "additionalProperties": false,
          "title": "Backend"
        }
      ],
      "title": "Policy Target"
    },
    "ListenerTarget": {
      "type": "object",
      "properties": {
        "gatewayName": {
          "type": "string",
          "title": "Gateway Name"
        },
        "gatewayNamespace": {
          "type": "string",
          "title": "Gateway Namespace"
        },
        "listenerName": {
          "type": [
            "string",
            "null"
          ],
          "title": "Listener Name"
        }
      },
      "additionalProperties": false,
      "required": [
        "gatewayName",
        "gatewayNamespace"
      ],
      "title": "Listener Target"
    },
    "RouteName": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "title": "Name"
        },
        "namespace": {
          "type": "string",
          "title": "Namespace"
        },
        "ruleName": {
          "type": [
            "string",
            "null"
          ],
          "title": "Rule Name"
        },
        "kind": {
          "type": [
            "string",
            "null"
          ],
          "title": "Kind"
        }
      },
      "additionalProperties": false,
      "required": [
        "name",
        "namespace"
      ],
      "title": "Route Name"
    },
    "BackendTarget": {
      "oneOf": [
        {
          "type": "string",
          "enum": [
            "invalid"
          ],
          "title": "Option 1"
        },
        {
          "type": "object",
          "properties": {
            "backend": {
              "type": "object",
              "properties": {
                "name": {
                  "type": "string"
                },
                "namespace": {
                  "type": "string"
                },
                "section": {
                  "type": [
                    "string",
                    "null"
                  ]
                }
              },
              "additionalProperties": false,
              "required": [
                "name",
                "namespace"
              ]
            }
          },
          "required": [
            "backend"
          ],
          "additionalProperties": false,
          "title": "Backend"
        },
        {
          "type": "object",
          "properties": {
            "service": {
              "type": "object",
              "properties": {
                "hostname": {
                  "type": "string"
                },
                "namespace": {
                  "type": "string"
                },
                "port": {
                  "type": [
                    "integer",
                    "null"
                  ],
                  "format": "uint16",
                  "minimum": 0,
                  "maximum": 65535
                }
              },
              "additionalProperties": false,
              "required": [
                "hostname",
                "namespace"
              ]
            }
          },
          "required": [
            "service"
          ],
          "additionalProperties": false,
          "title": "Service"
        }
      ],
      "title": "Backend Target"
    },
    "PolicyPhase": {
      "type": "string",
      "enum": [
        "route",
        "gateway"
      ],
      "title": "Policy Phase"
    },
    "FilterOrPolicy": {
      "type": "object",
      "properties": {
        "requestHeaderModifier": {
          "description": "Headers to be modified in the request.",
          "anyOf": [
            {
              "$ref": "#/$defs/HeaderModifier",
              "title": "Header Modifier"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Request Header Modifier"
        },
        "responseHeaderModifier": {
          "description": "Headers to be modified in the response.",
          "anyOf": [
            {
              "$ref": "#/$defs/HeaderModifier",
              "title": "Header Modifier"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Response Header Modifier"
        },
        "requestRedirect": {
          "description": "Directly respond to the request with a redirect.",
          "anyOf": [
            {
              "$ref": "#/$defs/RequestRedirect",
              "title": "Request Redirect"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Request Redirect"
        },
        "urlRewrite": {
          "description": "Modify the URL path or authority.",
          "anyOf": [
            {
              "$ref": "#/$defs/UrlRewrite",
              "title": "Url Rewrite"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Url Rewrite"
        },
        "requestMirror": {
          "description": "Mirror incoming requests to another destination.",
          "anyOf": [
            {
              "$ref": "#/$defs/RequestMirror",
              "title": "Request Mirror"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Request Mirror"
        },
        "directResponse": {
          "description": "Directly respond to the request with a static response.",
          "anyOf": [
            {
              "$ref": "#/$defs/DirectResponse",
              "title": "Direct Response"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Direct Response"
        },
        "cors": {
          "description": "Handle CORS preflight requests and append configured CORS headers to applicable requests.",
          "anyOf": [
            {
              "$ref": "#/$defs/CorsSerde",
              "title": "Cors Serde"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Cors"
        },
        "mcpAuthorization": {
          "description": "Authorization policies for MCP access.",
          "anyOf": [
            {
              "$ref": "#/$defs/McpAuthorization",
              "title": "Mcp Authorization"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Mcp Authorization"
        },
        "authorization": {
          "description": "Authorization policies for HTTP access.",
          "anyOf": [
            {
              "$ref": "#/$defs/Authorization",
              "title": "Authorization"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Authorization"
        },
        "mcpAuthentication": {
          "description": "Authentication for MCP clients.",
          "anyOf": [
            {
              "$ref": "#/$defs/LocalMcpAuthentication",
              "title": "Local Mcp Authentication"
            },
            {
              "type": "null"
            }
          ],
          "title": "Mcp Authentication"
        },
        "a2a": {
          "description": "Mark this traffic as A2A to enable A2A processing and telemetry.",
          "anyOf": [
            {
              "$ref": "#/$defs/A2aPolicy",
              "title": "A2a Policy"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "A2a"
        },
        "ai": {
          "description": "Mark this as LLM traffic to enable LLM processing.",
          "anyOf": [
            {
              "$ref": "#/$defs/Policy",
              "title": "Policy"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Ai"
        },
        "backendTLS": {
          "description": "Send TLS to the backend.",
          "anyOf": [
            {
              "$ref": "#/$defs/LocalBackendTLS",
              "title": "Local Backend TLS"
            },
            {
              "type": "null"
            }
          ],
          "title": "Backend TLS"
        },
        "backendAuth": {
          "description": "Authenticate to the backend.",
          "anyOf": [
            {
              "$ref": "#/$defs/BackendAuth",
              "title": "Backend Auth"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Backend Auth"
        },
        "localRateLimit": {
          "description": "Rate limit incoming requests. State is kept local.",
          "type": "array",
          "items": {
            "$ref": "#/$defs/RateLimitSpec"
          },
          "default": [],
          "title": "Local Rate Limit"
        },
        "remoteRateLimit": {
          "description": "Rate limit incoming requests. State is managed by a remote server.",
          "anyOf": [
            {
              "$ref": "#/$defs/RemoteRateLimit",
              "title": "Remote Rate Limit"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Remote Rate Limit"
        },
        "jwtAuth": {
          "description": "Authenticate incoming JWT requests.",
          "anyOf": [
            {
              "$ref": "#/$defs/LocalJwtConfig",
              "title": "Local Jwt Config"
            },
            {
              "type": "null"
            }
          ],
          "title": "Jwt Auth"
        },
        "basicAuth": {
          "description": "Authenticate incoming requests using Basic Authentication with htpasswd.",
          "anyOf": [
            {
              "$ref": "#/$defs/LocalBasicAuth",
              "title": "Local Basic Auth"
            },
            {
              "type": "null"
            }
          ],
          "title": "Basic Auth"
        },
        "apiKey": {
          "description": "Authenticate incoming requests using API Keys",
          "anyOf": [
            {
              "$ref": "#/$defs/LocalAPIKeys",
              "title": "Local API Keys"
            },
            {
              "type": "null"
            }
          ],
          "title": "Api Key"
        },
        "extAuthz": {
          "description": "Authenticate incoming requests by calling an external authorization server.",
          "anyOf": [
            {
              "$ref": "#/$defs/ExtAuthz",
              "title": "Ext Authz"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Ext Authz"
        },
        "extProc": {
          "description": "Extend agentgateway with an external processor",
          "anyOf": [
            {
              "$ref": "#/$defs/ExtProc",
              "title": "Ext Proc"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Ext Proc"
        },
        "transformations": {
          "description": "Modify requests and responses",
          "anyOf": [
            {
              "$ref": "#/$defs/LocalTransformationConfig",
              "title": "Local Transformation Config"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Transformations"
        },
        "csrf": {
          "description": "Handle CSRF protection by validating request origins against configured allowed origins.",
          "anyOf": [
            {
              "$ref": "#/$defs/Csrf",
              "title": "Csrf"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Csrf"
        },
        "timeout": {
          "description": "Timeout requests that exceed the configured duration.",
          "anyOf": [
            {
              "$ref": "#/$defs/Policy2",
              "title": "Policy2"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Timeout"
        },
        "retry": {
          "description": "Retry matching requests.",
          "anyOf": [
            {
              "$ref": "#/$defs/Policy3",
              "title": "Policy3"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Retry"
        }
      },
      "additionalProperties": false,
      "title": "Filter Or Policy"
    },
    "HeaderModifier": {
      "type": "object",
      "properties": {
        "add": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          },
          "title": "Add"
        },
        "set": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          },
          "title": "Set"
        },
        "remove": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "title": "Remove"
        }
      },
      "additionalProperties": false,
      "title": "Header Modifier"
    },
    "RequestRedirect": {
      "type": "object",
      "properties": {
        "scheme": {
          "type": [
            "string",
            "null"
          ],
          "title": "Scheme"
        },
        "authority": {
          "anyOf": [
            {
              "$ref": "#/$defs/HostRedirect",
              "title": "Host Redirect"
            },
            {
              "type": "null"
            }
          ],
          "title": "Authority"
        },
        "path": {
          "anyOf": [
            {
              "$ref": "#/$defs/PathRedirect",
              "title": "Path Redirect"
            },
            {
              "type": "null"
            }
          ],
          "title": "Path"
        },
        "status": {
          "type": [
            "integer",
            "null"
          ],
          "format": "uint16",
          "minimum": 1,
          "maximum": 65535,
          "title": "Status"
        }
      },
      "additionalProperties": false,
      "title": "Request Redirect"
    },
    "HostRedirect": {
      "oneOf": [
        {
          "type": "string",
          "enum": [
            "auto",
            "none"
          ],
          "title": "Option 1"
        },
        {
          "type": "object",
          "properties": {
            "full": {
              "type": "string"
            }
          },
          "required": [
            "full"
          ],
          "additionalProperties": false,
          "title": "Full"
        },
        {
          "type": "object",
          "properties": {
            "host": {
              "type": "string"
            }
          },
          "required": [
            "host"
          ],
          "additionalProperties": false,
          "title": "Host"
        },
        {
          "type": "object",
          "properties": {
            "port": {
              "type": "integer",
              "format": "uint16",
              "minimum": 1,
              "maximum": 65535
            }
          },
          "required": [
            "port"
          ],
          "additionalProperties": false,
          "title": "Port"
        }
      ],
      "title": "Host Redirect"
    },
    "PathRedirect": {
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "full": {
              "type": "string"
            }
          },
          "required": [
            "full"
          ],
          "additionalProperties": false,
          "title": "Full"
        },
        {
          "type": "object",
          "properties": {
            "prefix": {
              "type": "string"
            }
          },
          "required": [
            "prefix"
          ],
          "additionalProperties": false,
          "title": "Prefix"
        }
      ],
      "title": "Path Redirect"
    },
    "UrlRewrite": {
      "type": "object",
      "properties": {
        "authority": {
          "anyOf": [
            {
              "$ref": "#/$defs/HostRedirect",
              "title": "Host Redirect"
            },
            {
              "type": "null"
            }
          ],
          "title": "Authority"
        },
        "path": {
          "anyOf": [
            {
              "$ref": "#/$defs/PathRedirect",
              "title": "Path Redirect"
            },
            {
              "type": "null"
            }
          ],
          "title": "Path"
        }
      },
      "additionalProperties": false,
      "title": "Url Rewrite"
    },
    "RequestMirror": {
      "type": "object",
      "properties": {
        "backend": {
          "$ref": "#/$defs/SimpleLocalBackend",
          "title": "Backend"
        },
        "percentage": {
          "type": "number",
          "format": "double",
          "title": "Percentage"
        }
      },
      "additionalProperties": false,
      "required": [
        "backend",
        "percentage"
      ],
      "title": "Request Mirror"
    },
    "SimpleLocalBackend": {
      "oneOf": [
        {
          "type": "string",
          "enum": [
            "invalid"
          ],
          "title": "Option 1"
        },
        {
          "description": "Service reference. Service must be defined in the top level services list.",
          "type": "object",
          "properties": {
            "service": {
              "type": "object",
              "properties": {
                "name": {
                  "$ref": "#/$defs/NamespacedHostname"
                },
                "port": {
                  "type": "integer",
                  "format": "uint16",
                  "minimum": 0,
                  "maximum": 65535
                }
              },
              "additionalProperties": false,
              "required": [
                "name",
                "port"
              ]
            }
          },
          "required": [
            "service"
          ],
          "additionalProperties": false,
          "title": "Service"
        },
        {
          "description": "Hostname or IP address",
          "type": "object",
          "properties": {
            "host": {
              "description": "Hostname or IP address",
              "type": "string"
            }
          },
          "required": [
            "host"
          ],
          "additionalProperties": false,
          "title": "Host"
        },
        {
          "type": "object",
          "properties": {
            "backend": {
              "description": "Explicit backend reference. Backend must be defined in the top level backends list",
              "type": "string"
            }
          },
          "required": [
            "backend"
          ],
          "additionalProperties": false,
          "title": "Backend"
        }
      ],
      "title": "Simple Local Backend"
    },
    "NamespacedHostname": {
      "type": "object",
      "properties": {
        "namespace": {
          "type": "string",
          "title": "Namespace"
        },
        "hostname": {
          "type": "string",
          "title": "Hostname"
        }
      },
      "required": [
        "namespace",
        "hostname"
      ],
      "title": "Namespaced Hostname"
    },
    "DirectResponse": {
      "type": "object",
      "properties": {
        "body": {
          "$ref": "#/$defs/Bytes",
          "title": "Body"
        },
        "status": {
          "type": "integer",
          "format": "uint16",
          "minimum": 1,
          "maximum": 65535,
          "title": "Status"
        }
      },
      "additionalProperties": false,
      "required": [
        "body",
        "status"
      ],
      "title": "Direct Response"
    },
    "Bytes": {
      "type": [
        "array",
        "string"
      ],
      "items": {
        "type": "integer",
        "format": "uint8",
        "minimum": 0,
        "maximum": 255
      },
      "title": "Bytes"
    },
    "CorsSerde": {
      "type": "object",
      "properties": {
        "allowCredentials": {
          "type": "boolean",
          "default": false,
          "title": "Allow Credentials"
        },
        "allowHeaders": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "default": [],
          "title": "Allow Headers"
        },
        "allowMethods": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "default": [],
          "title": "Allow Methods"
        },
        "allowOrigins": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "default": [],
          "title": "Allow Origins"
        },
        "exposeHeaders": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "default": [],
          "title": "Expose Headers"
        },
        "maxAge": {
          "type": [
            "string",
            "null"
          ],
          "default": null,
          "title": "Max Age"
        }
      },
      "additionalProperties": false,
      "title": "Cors Serde"
    },
    "McpAuthorization": {
      "$ref": "#/$defs/RuleSet",
      "title": "Mcp Authorization"
    },
    "RuleSet": {
      "type": "object",
      "properties": {
        "rules": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "title": "Rules"
        }
      },
      "additionalProperties": false,
      "required": [
        "rules"
      ],
      "title": "Rule Set"
    },
    "Authorization": {
      "$ref": "#/$defs/RuleSet",
      "title": "Authorization"
    },
    "LocalMcpAuthentication": {
      "type": "object",
      "properties": {
        "issuer": {
          "type": "string",
          "title": "Issuer"
        },
        "audiences": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "title": "Audiences"
        },
        "provider": {
          "anyOf": [
            {
              "$ref": "#/$defs/McpIDP",
              "title": "Mcp IDP"
            },
            {
              "type": "null"
            }
          ],
          "title": "Provider"
        },
        "resourceMetadata": {
          "$ref": "#/$defs/ResourceMetadata",
          "title": "Resource Metadata"
        },
        "jwks": {
          "$ref": "#/$defs/FileInlineOrRemote",
          "title": "Jwks"
        },
        "mode": {
          "$ref": "#/$defs/McpAuthenticationMode",
          "default": "strict",
          "title": "Mode"
        }
      },
      "additionalProperties": false,
      "required": [
        "issuer",
        "audiences",
        "resourceMetadata",
        "jwks"
      ],
      "title": "Local Mcp Authentication"
    },
    "McpIDP": {
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "auth0": {
              "type": "object",
              "additionalProperties": false
            }
          },
          "required": [
            "auth0"
          ],
          "additionalProperties": false,
          "title": "Auth0"
        },
        {
          "type": "object",
          "properties": {
            "keycloak": {
              "type": "object",
              "additionalProperties": false
            }
          },
          "required": [
            "keycloak"
          ],
          "additionalProperties": false,
          "title": "Keycloak"
        }
      ],
      "title": "Mcp IDP"
    },
    "ResourceMetadata": {
      "type": "object",
      "additionalProperties": true,
      "title": "Resource Metadata"
    },
    "FileInlineOrRemote": {
      "anyOf": [
        {
          "type": "object",
          "properties": {
            "file": {
              "type": "string"
            }
          },
          "required": [
            "file"
          ],
          "title": "File"
        },
        {
          "type": "string"
        },
        {
          "type": "object",
          "properties": {
            "url": {
              "type": "string"
            }
          },
          "required": [
            "url"
          ],
          "title": "Url"
        }
      ],
      "title": "File Inline Or Remote"
    },
    "McpAuthenticationMode": {
      "oneOf": [
        {
          "description": "A valid token, issued by a configured issuer, must be present.\nThis is the default option.",
          "type": "string",
          "const": "strict",
          "title": "Strict"
        },
        {
          "description": "If a token exists, validate it.\nWarning: this allows requests without a JWT token! Additionally, 401 errors will not be returned,\nwhich will not trigger clients to initiate an oauth flow.",
          "type": "string",
          "const": "optional",
          "title": "Optional"
        },
        {
          "description": "Requests are never rejected. This is useful for usage of claims in later steps (authorization, logging, etc).\nWarning: this allows requests without a JWT token! Additionally, 401 errors will not be returned,\nwhich will not trigger clients to initiate an oauth flow.",
          "type": "string",
          "const": "permissive",
          "title": "Permissive"
        }
      ],
      "title": "Mcp Authentication Mode"
    },
    "A2aPolicy": {
      "type": "object",
      "additionalProperties": false,
      "title": "A2a Policy"
    },
    "Policy": {
      "type": "object",
      "properties": {
        "promptGuard": {
          "anyOf": [
            {
              "$ref": "#/$defs/PromptGuard",
              "title": "Prompt Guard"
            },
            {
              "type": "null"
            }
          ],
          "title": "Prompt Guard"
        },
        "defaults": {
          "type": [
            "object",
            "null"
          ],
          "additionalProperties": true,
          "title": "Defaults"
        },
        "overrides": {
          "type": [
            "object",
            "null"
          ],
          "additionalProperties": true,
          "title": "Overrides"
        },
        "prompts": {
          "anyOf": [
            {
              "$ref": "#/$defs/PromptEnrichment",
              "title": "Prompt Enrichment"
            },
            {
              "type": "null"
            }
          ],
          "title": "Prompts"
        },
        "modelAliases": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          },
          "title": "Model Aliases"
        },
        "promptCaching": {
          "anyOf": [
            {
              "$ref": "#/$defs/PromptCachingConfig",
              "title": "Prompt Caching Config"
            },
            {
              "type": "null"
            }
          ],
          "title": "Prompt Caching"
        },
        "routes": {
          "type": "object",
          "additionalProperties": {
            "$ref": "#/$defs/RouteType"
          },
          "title": "Routes"
        }
      },
      "additionalProperties": false,
      "title": "Policy"
    },
    "PromptGuard": {
      "type": "object",
      "properties": {
        "request": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/RequestGuard"
          },
          "title": "Request"
        },
        "response": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/ResponseGuard"
          },
          "title": "Response"
        }
      },
      "additionalProperties": false,
      "title": "Prompt Guard"
    },
    "RequestGuard": {
      "type": "object",
      "properties": {
        "rejection": {
          "$ref": "#/$defs/RequestRejection",
          "default": {
            "body": "The request was rejected due to inappropriate content",
            "status": 403
          },
          "title": "Rejection"
        }
      },
      "unevaluatedProperties": false,
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "regex": {
              "$ref": "#/$defs/RegexRules"
            }
          },
          "required": [
            "regex"
          ],
          "title": "Regex"
        },
        {
          "type": "object",
          "properties": {
            "webhook": {
              "$ref": "#/$defs/Webhook"
            }
          },
          "required": [
            "webhook"
          ],
          "title": "Webhook"
        },
        {
          "type": "object",
          "properties": {
            "openAIModeration": {
              "$ref": "#/$defs/Moderation"
            }
          },
          "required": [
            "openAIModeration"
          ],
          "title": "Open AI Moderation"
        },
        {
          "type": "object",
          "properties": {
            "bedrockGuardrails": {
              "$ref": "#/$defs/BedrockGuardrails"
            }
          },
          "required": [
            "bedrockGuardrails"
          ],
          "title": "Bedrock Guardrails"
        },
        {
          "type": "object",
          "properties": {
            "googleModelArmor": {
              "$ref": "#/$defs/GoogleModelArmor"
            }
          },
          "required": [
            "googleModelArmor"
          ],
          "title": "Google Model Armor"
        }
      ],
      "title": "Request Guard"
    },
    "RequestRejection": {
      "type": "object",
      "properties": {
        "body": {
          "$ref": "#/$defs/Bytes",
          "default": "The request was rejected due to inappropriate content",
          "title": "Body"
        },
        "status": {
          "type": "integer",
          "format": "uint16",
          "minimum": 1,
          "maximum": 65535,
          "default": 403,
          "title": "Status"
        },
        "headers": {
          "description": "Optional headers to add, set, or remove from the rejection response",
          "anyOf": [
            {
              "$ref": "#/$defs/HeaderModifier",
              "title": "Header Modifier"
            },
            {
              "type": "null"
            }
          ],
          "title": "Headers"
        }
      },
      "additionalProperties": false,
      "title": "Request Rejection"
    },
    "RegexRules": {
      "type": "object",
      "properties": {
        "action": {
          "$ref": "#/$defs/Action",
          "default": "mask",
          "title": "Action"
        },
        "rules": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/RegexRule"
          },
          "title": "Rules"
        }
      },
      "additionalProperties": false,
      "required": [
        "rules"
      ],
      "title": "Regex Rules"
    },
    "Action": {
      "type": "string",
      "enum": [
        "mask",
        "reject"
      ],
      "title": "Action"
    },
    "RegexRule": {
      "anyOf": [
        {
          "type": "object",
          "properties": {
            "builtin": {
              "$ref": "#/$defs/Builtin"
            }
          },
          "additionalProperties": false,
          "required": [
            "builtin"
          ],
          "title": "Builtin"
        },
        {
          "type": "object",
          "properties": {
            "pattern": {
              "type": "string"
            }
          },
          "additionalProperties": false,
          "required": [
            "pattern"
          ],
          "title": "Pattern"
        }
      ],
      "title": "Regex Rule"
    },
    "Builtin": {
      "type": "string",
      "enum": [
        "ssn",
        "creditCard",
        "phoneNumber",
        "email",
        "caSin"
      ],
      "title": "Builtin"
    },
    "Webhook": {
      "type": "object",
      "properties": {
        "target": {
          "$ref": "#/$defs/SimpleLocalBackend",
          "title": "Target"
        },
        "forwardHeaderMatches": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/HeaderMatch"
          },
          "title": "Forward Header Matches"
        }
      },
      "additionalProperties": false,
      "required": [
        "target"
      ],
      "title": "Webhook"
    },
    "HeaderMatch": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "title": "Name"
        },
        "value": {
          "$ref": "#/$defs/HeaderValueMatch",
          "title": "Value"
        }
      },
      "additionalProperties": false,
      "required": [
        "name",
        "value"
      ],
      "title": "Header Match"
    },
    "HeaderValueMatch": {
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "exact": {
              "type": "string"
            }
          },
          "required": [
            "exact"
          ],
          "additionalProperties": false,
          "title": "Exact"
        },
        {
          "type": "object",
          "properties": {
            "regex": {
              "type": "string"
            }
          },
          "required": [
            "regex"
          ],
          "additionalProperties": false,
          "title": "Regex"
        }
      ],
      "title": "Header Value Match"
    },
    "Moderation": {
      "type": "object",
      "properties": {
        "model": {
          "description": "Model to use. Defaults to `omni-moderation-latest`",
          "type": [
            "string",
            "null"
          ],
          "title": "Model"
        },
        "policies": {
          "$ref": "#/$defs/LocalBackendPolicies",
          "title": "Policies"
        }
      },
      "additionalProperties": false,
      "required": [
        "policies"
      ],
      "title": "Moderation"
    },
    "LocalBackendPolicies": {
      "type": "object",
      "properties": {
        "requestHeaderModifier": {
          "description": "Headers to be modified in the request.",
          "anyOf": [
            {
              "$ref": "#/$defs/HeaderModifier",
              "title": "Header Modifier"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Request Header Modifier"
        },
        "responseHeaderModifier": {
          "description": "Headers to be modified in the response.",
          "anyOf": [
            {
              "$ref": "#/$defs/HeaderModifier",
              "title": "Header Modifier"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Response Header Modifier"
        },
        "requestRedirect": {
          "description": "Directly respond to the request with a redirect.",
          "anyOf": [
            {
              "$ref": "#/$defs/RequestRedirect",
              "title": "Request Redirect"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Request Redirect"
        },
        "mcpAuthorization": {
          "description": "Authorization policies for MCP access.",
          "anyOf": [
            {
              "$ref": "#/$defs/McpAuthorization",
              "title": "Mcp Authorization"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Mcp Authorization"
        },
        "a2a": {
          "description": "Mark this traffic as A2A to enable A2A processing and telemetry.",
          "anyOf": [
            {
              "$ref": "#/$defs/A2aPolicy",
              "title": "A2a Policy"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "A2a"
        },
        "ai": {
          "description": "Mark this as LLM traffic to enable LLM processing.",
          "anyOf": [
            {
              "$ref": "#/$defs/Policy",
              "title": "Policy"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Ai"
        },
        "backendTLS": {
          "description": "Send TLS to the backend.",
          "anyOf": [
            {
              "$ref": "#/$defs/LocalBackendTLS",
              "title": "Local Backend TLS"
            },
            {
              "type": "null"
            }
          ],
          "title": "Backend TLS"
        },
        "backendAuth": {
          "description": "Authenticate to the backend.",
          "anyOf": [
            {
              "$ref": "#/$defs/BackendAuth",
              "title": "Backend Auth"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Backend Auth"
        },
        "http": {
          "description": "Specify HTTP settings for the backend",
          "anyOf": [
            {
              "$ref": "#/$defs/HTTP",
              "title": "HTTP"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Http"
        },
        "tcp": {
          "description": "Specify TCP settings for the backend",
          "anyOf": [
            {
              "$ref": "#/$defs/TCP",
              "title": "TCP"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Tcp"
        }
      },
      "additionalProperties": false,
      "title": "Local Backend Policies"
    },
    "LocalBackendTLS": {
      "type": "object",
      "properties": {
        "cert": {
          "type": [
            "string",
            "null"
          ],
          "title": "Cert"
        },
        "key": {
          "type": [
            "string",
            "null"
          ],
          "title": "Key"
        },
        "root": {
          "type": [
            "string",
            "null"
          ],
          "title": "Root"
        },
        "hostname": {
          "type": [
            "string",
            "null"
          ],
          "title": "Hostname"
        },
        "insecure": {
          "type": "boolean",
          "default": false,
          "title": "Insecure"
        },
        "insecureHost": {
          "type": "boolean",
          "default": false,
          "title": "Insecure Host"
        },
        "alpn": {
          "type": [
            "array",
            "null"
          ],
          "items": {
            "type": "string"
          },
          "default": null,
          "title": "Alpn"
        },
        "subjectAltNames": {
          "type": [
            "array",
            "null"
          ],
          "items": {
            "type": "string"
          },
          "default": null,
          "title": "Subject Alt Names"
        }
      },
      "additionalProperties": false,
      "title": "Local Backend TLS"
    },
    "BackendAuth": {
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "passthrough": {
              "type": "object",
              "additionalProperties": false
            }
          },
          "required": [
            "passthrough"
          ],
          "additionalProperties": false,
          "title": "Passthrough"
        },
        {
          "type": "object",
          "properties": {
            "key": {
              "$ref": "#/$defs/FileOrInline"
            }
          },
          "required": [
            "key"
          ],
          "additionalProperties": false,
          "title": "Key"
        },
        {
          "type": "object",
          "properties": {
            "gcp": {
              "$ref": "#/$defs/GcpAuth"
            }
          },
          "required": [
            "gcp"
          ],
          "additionalProperties": false,
          "title": "Gcp"
        },
        {
          "type": "object",
          "properties": {
            "aws": {
              "$ref": "#/$defs/AwsAuth"
            }
          },
          "required": [
            "aws"
          ],
          "additionalProperties": false,
          "title": "Aws"
        },
        {
          "type": "object",
          "properties": {
            "azure": {
              "$ref": "#/$defs/AzureAuth"
            }
          },
          "required": [
            "azure"
          ],
          "additionalProperties": false,
          "title": "Azure"
        }
      ],
      "title": "Backend Auth"
    },
    "FileOrInline": {
      "anyOf": [
        {
          "type": "object",
          "properties": {
            "file": {
              "type": "string"
            }
          },
          "required": [
            "file"
          ],
          "title": "File"
        },
        {
          "type": "string"
        }
      ],
      "title": "File Or Inline"
    },
    "GcpAuth": {
      "anyOf": [
        {
          "description": "Fetch an id token",
          "type": "object",
          "properties": {
            "type": {
              "$ref": "#/$defs/IdToken"
            },
            "audience": {
              "description": "Audience for the token. If not set, the destination host will be used.",
              "type": [
                "string",
                "null"
              ]
            }
          },
          "additionalProperties": false,
          "required": [
            "type"
          ],
          "title": "Type"
        },
        {
          "description": "Fetch an access token",
          "type": "object",
          "properties": {
            "type": {
              "anyOf": [
                {
                  "$ref": "#/$defs/AccessToken"
                },
                {
                  "type": "null"
                }
              ],
              "default": null
            }
          },
          "additionalProperties": false,
          "title": "Type"
        }
      ],
      "title": "Gcp Auth"
    },
    "IdToken": {
      "type": "string",
      "format": "const",
      "const": "idToken",
      "title": "Id Token"
    },
    "AccessToken": {
      "type": "string",
      "format": "const",
      "const": "accessToken",
      "title": "Access Token"
    },
    "AwsAuth": {
      "anyOf": [
        {
          "description": "Use explicit AWS credentials",
          "type": "object",
          "properties": {
            "accessKeyId": {
              "type": "string"
            },
            "secretAccessKey": {
              "type": "string"
            },
            "region": {
              "type": [
                "string",
                "null"
              ]
            },
            "sessionToken": {
              "type": [
                "string",
                "null"
              ]
            }
          },
          "additionalProperties": false,
          "required": [
            "accessKeyId",
            "secretAccessKey"
          ],
          "title": "Access Key Id"
        },
        {
          "description": "Use implicit AWS authentication (environment variables, IAM roles, etc.)",
          "type": "object",
          "additionalProperties": false
        }
      ],
      "title": "Aws Auth"
    },
    "AzureAuth": {
      "oneOf": [
        {
          "description": "Use explicit Azure credentials",
          "type": "object",
          "properties": {
            "explicitConfig": {
              "type": "object",
              "unevaluatedProperties": false,
              "oneOf": [
                {
                  "type": "object",
                  "properties": {
                    "clientSecret": {
                      "type": "object",
                      "properties": {
                        "tenant_id": {
                          "type": "string"
                        },
                        "client_id": {
                          "type": "string"
                        },
                        "client_secret": {
                          "type": "string"
                        }
                      },
                      "additionalProperties": false,
                      "required": [
                        "tenant_id",
                        "client_id",
                        "client_secret"
                      ]
                    }
                  },
                  "required": [
                    "clientSecret"
                  ]
                },
                {
                  "type": "object",
                  "properties": {
                    "managedIdentity": {
                      "type": "object",
                      "properties": {
                        "userAssignedIdentity": {
                          "anyOf": [
                            {
                              "$ref": "#/$defs/AzureUserAssignedIdentity"
                            },
                            {
                              "type": "null"
                            }
                          ]
                        }
                      },
                      "additionalProperties": false
                    }
                  },
                  "required": [
                    "managedIdentity"
                  ]
                },
                {
                  "type": "object",
                  "properties": {
                    "workloadIdentity": {
                      "type": "object",
                      "additionalProperties": false
                    }
                  },
                  "required": [
                    "workloadIdentity"
                  ]
                }
              ]
            }
          },
          "required": [
            "explicitConfig"
          ],
          "additionalProperties": false,
          "title": "Explicit Config"
        },
        {
          "description": "Use implicit Azure auth. Note that this is for developer use-cases only!",
          "type": "object",
          "properties": {
            "developerImplicit": {
              "type": "object",
              "additionalProperties": false
            }
          },
          "required": [
            "developerImplicit"
          ],
          "additionalProperties": false,
          "title": "Developer Implicit"
        }
      ],
      "title": "Azure Auth"
    },
    "AzureUserAssignedIdentity": {
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "clientId": {
              "type": "string"
            }
          },
          "required": [
            "clientId"
          ],
          "additionalProperties": false,
          "title": "Client Id"
        },
        {
          "type": "object",
          "properties": {
            "objectId": {
              "type": "string"
            }
          },
          "required": [
            "objectId"
          ],
          "additionalProperties": false,
          "title": "Object Id"
        },
        {
          "type": "object",
          "properties": {
            "resourceId": {
              "type": "string"
            }
          },
          "required": [
            "resourceId"
          ],
          "additionalProperties": false,
          "title": "Resource Id"
        }
      ],
      "title": "Azure User Assigned Identity"
    },
    "HTTP": {
      "type": "object",
      "properties": {
        "version": {
          "type": [
            "string",
            "null"
          ],
          "default": null,
          "title": "Version"
        },
        "requestTimeout": {
          "type": [
            "string",
            "null"
          ],
          "title": "Request Timeout"
        }
      },
      "additionalProperties": false,
      "title": "HTTP"
    },
    "TCP": {
      "type": "object",
      "properties": {
        "keepalives": {
          "$ref": "#/$defs/KeepaliveConfig",
          "title": "Keepalives"
        },
        "connectTimeout": {
          "$ref": "#/$defs/Duration",
          "title": "Connect Timeout"
        }
      },
      "additionalProperties": false,
      "required": [
        "keepalives",
        "connectTimeout"
      ],
      "title": "TCP"
    },
    "KeepaliveConfig": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": true,
          "title": "Enabled"
        },
        "time": {
          "type": "string",
          "default": "3m0s",
          "title": "Time"
        },
        "interval": {
          "type": "string",
          "default": "3m0s",
          "title": "Interval"
        },
        "retries": {
          "type": "integer",
          "format": "uint32",
          "minimum": 0,
          "default": 9,
          "title": "Retries"
        }
      },
      "additionalProperties": false,
      "title": "Keepalive Config"
    },
    "Duration": {
      "type": "object",
      "properties": {
        "secs": {
          "type": "integer",
          "format": "uint64",
          "minimum": 0,
          "title": "Secs"
        },
        "nanos": {
          "type": "integer",
          "format": "uint32",
          "minimum": 0,
          "title": "Nanos"
        }
      },
      "required": [
        "secs",
        "nanos"
      ],
      "title": "Duration"
    },
    "BedrockGuardrails": {
      "description": "Configuration for AWS Bedrock Guardrails integration.",
      "type": "object",
      "properties": {
        "guardrailIdentifier": {
          "description": "The unique identifier of the guardrail",
          "type": "string",
          "title": "Guardrail Identifier"
        },
        "guardrailVersion": {
          "description": "The version of the guardrail",
          "type": "string",
          "title": "Guardrail Version"
        },
        "region": {
          "description": "AWS region where the guardrail is deployed",
          "type": "string",
          "title": "Region"
        },
        "policies": {
          "description": "Backend policies for AWS authentication (optional, defaults to implicit AWS auth)",
          "anyOf": [
            {
              "$ref": "#/$defs/LocalBackendPolicies",
              "title": "Local Backend Policies"
            },
            {
              "type": "null"
            }
          ],
          "title": "Policies"
        }
      },
      "additionalProperties": false,
      "required": [
        "guardrailIdentifier",
        "guardrailVersion",
        "region"
      ],
      "title": "Bedrock Guardrails"
    },
    "GoogleModelArmor": {
      "description": "Configuration for Google Cloud Model Armor integration.",
      "type": "object",
      "properties": {
        "templateId": {
          "description": "The template ID for the Model Armor configuration",
          "type": "string",
          "title": "Template Id"
        },
        "projectId": {
          "description": "The GCP project ID",
          "type": "string",
          "title": "Project Id"
        },
        "location": {
          "description": "The GCP region (default: us-central1)",
          "type": [
            "string",
            "null"
          ],
          "title": "Location"
        },
        "policies": {
          "description": "Backend policies for GCP authentication (optional, defaults to implicit GCP auth)",
          "anyOf": [
            {
              "$ref": "#/$defs/LocalBackendPolicies",
              "title": "Local Backend Policies"
            },
            {
              "type": "null"
            }
          ],
          "title": "Policies"
        }
      },
      "additionalProperties": false,
      "required": [
        "templateId",
        "projectId"
      ],
      "title": "Google Model Armor"
    },
    "ResponseGuard": {
      "type": "object",
      "properties": {
        "rejection": {
          "$ref": "#/$defs/RequestRejection",
          "default": {
            "body": "The request was rejected due to inappropriate content",
            "status": 403
          },
          "title": "Rejection"
        }
      },
      "unevaluatedProperties": false,
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "regex": {
              "$ref": "#/$defs/RegexRules"
            }
          },
          "required": [
            "regex"
          ],
          "title": "Regex"
        },
        {
          "type": "object",
          "properties": {
            "webhook": {
              "$ref": "#/$defs/Webhook"
            }
          },
          "required": [
            "webhook"
          ],
          "title": "Webhook"
        },
        {
          "type": "object",
          "properties": {
            "bedrockGuardrails": {
              "$ref": "#/$defs/BedrockGuardrails"
            }
          },
          "required": [
            "bedrockGuardrails"
          ],
          "title": "Bedrock Guardrails"
        },
        {
          "type": "object",
          "properties": {
            "googleModelArmor": {
              "$ref": "#/$defs/GoogleModelArmor"
            }
          },
          "required": [
            "googleModelArmor"
          ],
          "title": "Google Model Armor"
        }
      ],
      "title": "Response Guard"
    },
    "PromptEnrichment": {
      "type": "object",
      "properties": {
        "append": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/SimpleChatCompletionMessage"
          },
          "title": "Append"
        },
        "prepend": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/SimpleChatCompletionMessage"
          },
          "title": "Prepend"
        }
      },
      "additionalProperties": false,
      "minProperties": 1,
      "title": "Prompt Enrichment"
    },
    "SimpleChatCompletionMessage": {
      "description": "SimpleChatCompletionMessage is a simplified chat message",
      "type": "object",
      "properties": {
        "role": {
          "type": "string",
          "title": "Role"
        },
        "content": {
          "type": "string",
          "title": "Content"
        }
      },
      "additionalProperties": false,
      "required": [
        "role",
        "content"
      ],
      "title": "Simple Chat Completion Message"
    },
    "PromptCachingConfig": {
      "type": "object",
      "properties": {
        "cacheSystem": {
          "type": "boolean",
          "default": true,
          "title": "Cache System"
        },
        "cacheMessages": {
          "type": "boolean",
          "default": true,
          "title": "Cache Messages"
        },
        "cacheTools": {
          "type": "boolean",
          "default": false,
          "title": "Cache Tools"
        },
        "minTokens": {
          "type": [
            "integer",
            "null"
          ],
          "format": "uint",
          "minimum": 0,
          "default": 1024,
          "title": "Min Tokens"
        }
      },
      "additionalProperties": false,
      "title": "Prompt Caching Config"
    },
    "RouteType": {
      "oneOf": [
        {
          "description": "OpenAI /v1/chat/completions",
          "type": "string",
          "const": "completions",
          "title": "Completions"
        },
        {
          "description": "Anthropic /v1/messages",
          "type": "string",
          "const": "messages",
          "title": "Messages"
        },
        {
          "description": "OpenAI /v1/models",
          "type": "string",
          "const": "models",
          "title": "Models"
        },
        {
          "description": "Send the request to the upstream LLM provider as-is",
          "type": "string",
          "const": "passthrough",
          "title": "Passthrough"
        },
        {
          "description": "OpenAI /responses",
          "type": "string",
          "const": "responses",
          "title": "Responses"
        },
        {
          "description": "OpenAI /embeddings",
          "type": "string",
          "const": "embeddings",
          "title": "Embeddings"
        },
        {
          "description": "OpenAI /realtime (websockets)",
          "type": "string",
          "const": "realtime",
          "title": "Realtime"
        },
        {
          "description": "Anthropic /v1/messages/count_tokens",
          "type": "string",
          "const": "anthropicTokenCount",
          "title": "Anthropic Token Count"
        }
      ],
      "title": "Route Type"
    },
    "RateLimitSpec": {
      "type": "object",
      "properties": {
        "maxTokens": {
          "type": "integer",
          "format": "uint64",
          "minimum": 0,
          "default": 0,
          "title": "Max Tokens"
        },
        "tokensPerFill": {
          "type": "integer",
          "format": "uint64",
          "minimum": 0,
          "default": 0,
          "title": "Tokens Per Fill"
        },
        "fillInterval": {
          "type": "string",
          "title": "Fill Interval"
        },
        "type": {
          "$ref": "#/$defs/RateLimitType",
          "default": "requests",
          "title": "Type"
        }
      },
      "additionalProperties": false,
      "required": [
        "fillInterval"
      ],
      "title": "Rate Limit Spec"
    },
    "RateLimitType": {
      "type": "string",
      "enum": [
        "requests",
        "tokens"
      ],
      "title": "Rate Limit Type"
    },
    "RemoteRateLimit": {
      "type": "object",
      "properties": {
        "domain": {
          "type": "string",
          "title": "Domain"
        },
        "descriptors": {
          "$ref": "#/$defs/DescriptorSet",
          "title": "Descriptors"
        },
        "timeout": {
          "description": "Timeout for the request",
          "type": [
            "string",
            "null"
          ],
          "title": "Timeout"
        }
      },
      "required": [
        "domain",
        "descriptors"
      ],
      "unevaluatedProperties": false,
      "oneOf": [
        {
          "type": "string",
          "enum": [
            "invalid"
          ],
          "title": "Option 1"
        },
        {
          "description": "Service reference. Service must be defined in the top level services list.",
          "type": "object",
          "properties": {
            "service": {
              "type": "object",
              "properties": {
                "name": {
                  "$ref": "#/$defs/NamespacedHostname"
                },
                "port": {
                  "type": "integer",
                  "format": "uint16",
                  "minimum": 0,
                  "maximum": 65535
                }
              },
              "additionalProperties": false,
              "required": [
                "name",
                "port"
              ]
            }
          },
          "required": [
            "service"
          ],
          "title": "Service"
        },
        {
          "description": "Hostname or IP address",
          "type": "object",
          "properties": {
            "host": {
              "description": "Hostname or IP address",
              "type": "string"
            }
          },
          "required": [
            "host"
          ],
          "title": "Host"
        },
        {
          "type": "object",
          "properties": {
            "backend": {
              "description": "Explicit backend reference. Backend must be defined in the top level backends list",
              "type": "string"
            }
          },
          "required": [
            "backend"
          ],
          "title": "Backend"
        }
      ],
      "title": "Remote Rate Limit"
    },
    "DescriptorSet": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/DescriptorEntry"
      },
      "title": "Descriptor Set"
    },
    "DescriptorEntry": {
      "type": "object",
      "properties": {
        "entries": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/KV"
          },
          "title": "Entries"
        },
        "type": {
          "$ref": "#/$defs/RateLimitType",
          "default": "requests",
          "title": "Type"
        }
      },
      "additionalProperties": false,
      "required": [
        "entries"
      ],
      "title": "Descriptor Entry"
    },
    "KV": {
      "type": "object",
      "properties": {
        "key": {
          "type": "string",
          "title": "Key"
        },
        "value": {
          "type": "string",
          "title": "Value"
        }
      },
      "required": [
        "key",
        "value"
      ],
      "title": "KV"
    },
    "LocalJwtConfig": {
      "anyOf": [
        {
          "type": "object",
          "properties": {
            "mode": {
              "$ref": "#/$defs/Mode",
              "default": "optional"
            },
            "providers": {
              "type": "array",
              "items": {
                "$ref": "#/$defs/ProviderConfig"
              }
            }
          },
          "additionalProperties": false,
          "required": [
            "providers"
          ],
          "title": "Mode"
        },
        {
          "type": "object",
          "properties": {
            "mode": {
              "$ref": "#/$defs/Mode",
              "default": "optional"
            },
            "issuer": {
              "type": "string"
            },
            "audiences": {
              "type": [
                "array",
                "null"
              ],
              "items": {
                "type": "string"
              }
            },
            "jwks": {
              "$ref": "#/$defs/FileInlineOrRemote"
            }
          },
          "additionalProperties": false,
          "required": [
            "issuer",
            "jwks"
          ],
          "title": "Mode"
        }
      ],
      "title": "Local Jwt Config"
    },
    "Mode": {
      "oneOf": [
        {
          "description": "A valid token, issued by a configured issuer, must be present.",
          "type": "string",
          "const": "strict",
          "title": "Strict"
        },
        {
          "description": "If a token exists, validate it.\nThis is the default option.\nWarning: this allows requests without a JWT token!",
          "type": "string",
          "const": "optional",
          "title": "Optional"
        },
        {
          "description": "Requests are never rejected. This is useful for usage of claims in later steps (authorization, logging, etc).\nWarning: this allows requests without a JWT token!",
          "type": "string",
          "const": "permissive",
          "title": "Permissive"
        }
      ],
      "title": "Mode"
    },
    "ProviderConfig": {
      "type": "object",
      "properties": {
        "issuer": {
          "type": "string",
          "title": "Issuer"
        },
        "audiences": {
          "type": [
            "array",
            "null"
          ],
          "items": {
            "type": "string"
          },
          "title": "Audiences"
        },
        "jwks": {
          "$ref": "#/$defs/FileInlineOrRemote",
          "title": "Jwks"
        }
      },
      "additionalProperties": false,
      "required": [
        "issuer",
        "jwks"
      ],
      "title": "Provider Config"
    },
    "LocalBasicAuth": {
      "type": "object",
      "properties": {
        "htpasswd": {
          "description": ".htpasswd file contents/reference",
          "$ref": "#/$defs/FileOrInline",
          "title": "Htpasswd"
        },
        "realm": {
          "description": "Realm name for the WWW-Authenticate header",
          "type": [
            "string",
            "null"
          ],
          "default": null,
          "title": "Realm"
        },
        "mode": {
          "description": "Validation mode for basic authentication",
          "$ref": "#/$defs/Mode2",
          "default": "optional",
          "title": "Mode"
        }
      },
      "additionalProperties": false,
      "required": [
        "htpasswd"
      ],
      "title": "Local Basic Auth"
    },
    "Mode2": {
      "description": "Validation mode for basic authentication",
      "oneOf": [
        {
          "description": "A valid username/password must be present.",
          "type": "string",
          "const": "strict",
          "title": "Strict"
        },
        {
          "description": "If credentials exist, validate them.\nThis is the default option.\nWarning: this allows requests without credentials!",
          "type": "string",
          "const": "optional",
          "title": "Optional"
        }
      ],
      "title": "Mode2"
    },
    "LocalAPIKeys": {
      "type": "object",
      "properties": {
        "keys": {
          "description": "List of API keys",
          "type": "array",
          "items": {
            "$ref": "#/$defs/LocalAPIKey"
          },
          "title": "Keys"
        },
        "mode": {
          "description": "Validation mode for API keys",
          "$ref": "#/$defs/Mode3",
          "default": "optional",
          "title": "Mode"
        }
      },
      "additionalProperties": false,
      "required": [
        "keys"
      ],
      "title": "Local API Keys"
    },
    "LocalAPIKey": {
      "type": "object",
      "properties": {
        "key": {
          "$ref": "#/$defs/APIKey",
          "title": "Key"
        },
        "metadata": true
      },
      "additionalProperties": false,
      "required": [
        "key"
      ],
      "title": "Local API Key"
    },
    "APIKey": {
      "type": "string",
      "title": "API Key"
    },
    "Mode3": {
      "description": "Validation mode for API Key authentication",
      "oneOf": [
        {
          "description": "A valid API Key must be present.",
          "type": "string",
          "const": "strict",
          "title": "Strict"
        },
        {
          "description": "If credentials exist, validate them.\nThis is the default option.\nWarning: this allows requests without credentials!",
          "type": "string",
          "const": "optional",
          "title": "Optional"
        }
      ],
      "title": "Mode3"
    },
    "ExtAuthz": {
      "type": "object",
      "properties": {
        "protocol": {
          "description": "The ext_authz protocol to use. Unless you need to integrate with an HTTP-only server, gRPC is recommended.",
          "$ref": "#/$defs/Protocol2",
          "default": {
            "grpc": {}
          },
          "title": "Protocol"
        },
        "failureMode": {
          "description": "Behavior when the authorization service is unavailable or returns an error",
          "$ref": "#/$defs/FailureMode",
          "default": "deny",
          "title": "Failure Mode"
        },
        "includeRequestHeaders": {
          "description": "Specific headers to include in the authorization request.\nIf unset, the gRPC protocol sends all request headers. The HTTP protocol sends only 'Authorization'.",
          "type": "array",
          "items": {
            "$ref": "#/$defs/HeaderOrPseudo"
          },
          "title": "Include Request Headers"
        },
        "includeRequestBody": {
          "description": "Options for including the request body in the authorization request",
          "anyOf": [
            {
              "$ref": "#/$defs/BodyOptions",
              "title": "Body Options"
            },
            {
              "type": "null"
            }
          ],
          "title": "Include Request Body"
        },
        "timeout": {
          "description": "Timeout for the authorization request (default: 200ms)",
          "type": [
            "string",
            "null"
          ],
          "title": "Timeout"
        }
      },
      "unevaluatedProperties": false,
      "oneOf": [
        {
          "type": "string",
          "enum": [
            "invalid"
          ],
          "title": "Option 1"
        },
        {
          "description": "Service reference. Service must be defined in the top level services list.",
          "type": "object",
          "properties": {
            "service": {
              "type": "object",
              "properties": {
                "name": {
                  "$ref": "#/$defs/NamespacedHostname"
                },
                "port": {
                  "type": "integer",
                  "format": "uint16",
                  "minimum": 0,
                  "maximum": 65535
                }
              },
              "additionalProperties": false,
              "required": [
                "name",
                "port"
              ]
            }
          },
          "required": [
            "service"
          ],
          "title": "Service"
        },
        {
          "description": "Hostname or IP address",
          "type": "object",
          "properties": {
            "host": {
              "description": "Hostname or IP address",
              "type": "string"
            }
          },
          "required": [
            "host"
          ],
          "title": "Host"
        },
        {
          "type": "object",
          "properties": {
            "backend": {
              "description": "Explicit backend reference. Backend must be defined in the top level backends list",
              "type": "string"
            }
          },
          "required": [
            "backend"
          ],
          "title": "Backend"
        }
      ],
      "title": "Ext Authz"
    },
    "Protocol2": {
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "grpc": {
              "type": "object",
              "properties": {
                "context": {
                  "description": "Additional context to send to the authorization service.\nThis maps to the `context_extensions` field of the request, and only allows static values.",
                  "type": [
                    "object",
                    "null"
                  ],
                  "additionalProperties": {
                    "type": "string"
                  }
                },
                "metadata": {
                  "description": "Additional metadata to send to the authorization service.\nThis maps to the `metadata_context.filter_metadata` field of the request, and allows dynamic CEL expressions.\nIf unset, by default the `envoy.filters.http.jwt_authn` key is set if the JWT policy is used as well, for compatibility.",
                  "type": [
                    "object",
                    "null"
                  ],
                  "additionalProperties": {
                    "$ref": "#/$defs/Expression"
                  }
                }
              },
              "additionalProperties": false
            }
          },
          "required": [
            "grpc"
          ],
          "additionalProperties": false,
          "title": "Grpc"
        },
        {
          "type": "object",
          "properties": {
            "http": {
              "type": "object",
              "properties": {
                "path": {
                  "anyOf": [
                    {
                      "$ref": "#/$defs/Expression"
                    },
                    {
                      "type": "null"
                    }
                  ]
                },
                "redirect": {
                  "description": "When using the HTTP protocol, and the server returns unauthorized, redirect to the URL resolved by\nthe provided expression rather than directly returning the error.",
                  "anyOf": [
                    {
                      "$ref": "#/$defs/Expression"
                    },
                    {
                      "type": "null"
                    }
                  ]
                },
                "includeResponseHeaders": {
                  "description": "Specific headers from the authorization response will be copied into the request to the backend.",
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                },
                "addRequestHeaders": {
                  "description": "Specific headers to add in the authorization request (empty = all headers), based on the expression",
                  "type": "object",
                  "additionalProperties": {
                    "$ref": "#/$defs/Expression"
                  }
                },
                "metadata": {
                  "description": "Metadata to include under the `extauthz` variable, based on the authorization response.",
                  "type": "object",
                  "additionalProperties": {
                    "$ref": "#/$defs/Expression"
                  }
                }
              },
              "additionalProperties": false
            }
          },
          "required": [
            "http"
          ],
          "additionalProperties": false,
          "title": "Http"
        }
      ],
      "title": "Protocol2"
    },
    "Expression": {
      "type": "string",
      "title": "Expression"
    },
    "FailureMode": {
      "oneOf": [
        {
          "type": "string",
          "enum": [
            "allow",
            "deny"
          ],
          "title": "Option 1"
        },
        {
          "type": "object",
          "properties": {
            "denyWithStatus": {
              "type": "integer",
              "format": "uint16",
              "minimum": 0,
              "maximum": 65535
            }
          },
          "required": [
            "denyWithStatus"
          ],
          "additionalProperties": false,
          "title": "Deny With Status"
        }
      ],
      "title": "Failure Mode"
    },
    "HeaderOrPseudo": {
      "type": "string",
      "title": "Header Or Pseudo"
    },
    "BodyOptions": {
      "type": "object",
      "properties": {
        "maxRequestBytes": {
          "description": "Maximum size of request body to buffer (default: 8192)",
          "type": "integer",
          "format": "uint32",
          "minimum": 0,
          "default": 0,
          "title": "Max Request Bytes"
        },
        "allowPartialMessage": {
          "description": "If true, send partial body when max_request_bytes is reached",
          "type": "boolean",
          "default": false,
          "title": "Allow Partial Message"
        },
        "packAsBytes": {
          "description": "If true, pack body as raw bytes in gRPC",
          "type": "boolean",
          "default": false,
          "title": "Pack As Bytes"
        }
      },
      "additionalProperties": false,
      "title": "Body Options"
    },
    "ExtProc": {
      "type": "object",
      "properties": {
        "failureMode": {
          "description": "Behavior when the ext_proc service is unavailable or returns an error",
          "$ref": "#/$defs/FailureMode2",
          "default": "failClosed",
          "title": "Failure Mode"
        },
        "metadataContext": {
          "description": "Additional metadata to send to the external processing service.\nMaps to the `metadata_context.filter_metadata` field in ProcessingRequest, and allows dynamic CEL expressions.",
          "type": [
            "object",
            "null"
          ],
          "additionalProperties": {
            "type": "object",
            "additionalProperties": {
              "$ref": "#/$defs/Expression"
            }
          },
          "title": "Metadata Context"
        },
        "requestAttributes": {
          "description": "Maps to the request `attributes` field in ProcessingRequest, and allows dynamic CEL expressions.",
          "type": [
            "object",
            "null"
          ],
          "additionalProperties": {
            "$ref": "#/$defs/Expression"
          },
          "title": "Request Attributes"
        },
        "responseAttributes": {
          "description": "Maps to the response `attributes` field in ProcessingRequest, and allows dynamic CEL expressions.",
          "type": [
            "object",
            "null"
          ],
          "additionalProperties": {
            "$ref": "#/$defs/Expression"
          },
          "title": "Response Attributes"
        }
      },
      "unevaluatedProperties": false,
      "oneOf": [
        {
          "type": "string",
          "enum": [
            "invalid"
          ],
          "title": "Option 1"
        },
        {
          "description": "Service reference. Service must be defined in the top level services list.",
          "type": "object",
          "properties": {
            "service": {
              "type": "object",
              "properties": {
                "name": {
                  "$ref": "#/$defs/NamespacedHostname"
                },
                "port": {
                  "type": "integer",
                  "format": "uint16",
                  "minimum": 0,
                  "maximum": 65535
                }
              },
              "additionalProperties": false,
              "required": [
                "name",
                "port"
              ]
            }
          },
          "required": [
            "service"
          ],
          "title": "Service"
        },
        {
          "description": "Hostname or IP address",
          "type": "object",
          "properties": {
            "host": {
              "description": "Hostname or IP address",
              "type": "string"
            }
          },
          "required": [
            "host"
          ],
          "title": "Host"
        },
        {
          "type": "object",
          "properties": {
            "backend": {
              "description": "Explicit backend reference. Backend must be defined in the top level backends list",
              "type": "string"
            }
          },
          "required": [
            "backend"
          ],
          "title": "Backend"
        }
      ],
      "title": "Ext Proc"
    },
    "FailureMode2": {
      "type": "string",
      "enum": [
        "failClosed",
        "failOpen"
      ],
      "title": "Failure Mode2"
    },
    "LocalTransformationConfig": {
      "type": "object",
      "properties": {
        "request": {
          "anyOf": [
            {
              "$ref": "#/$defs/LocalTransform",
              "title": "Local Transform"
            },
            {
              "type": "null"
            }
          ],
          "title": "Request"
        },
        "response": {
          "anyOf": [
            {
              "$ref": "#/$defs/LocalTransform",
              "title": "Local Transform"
            },
            {
              "type": "null"
            }
          ],
          "title": "Response"
        }
      },
      "additionalProperties": false,
      "title": "Local Transformation Config"
    },
    "LocalTransform": {
      "type": "object",
      "properties": {
        "add": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          },
          "default": {},
          "title": "Add"
        },
        "set": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          },
          "default": {},
          "title": "Set"
        },
        "remove": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "default": [],
          "title": "Remove"
        },
        "body": {
          "type": [
            "string",
            "null"
          ],
          "default": null,
          "title": "Body"
        }
      },
      "additionalProperties": false,
      "title": "Local Transform"
    },
    "Csrf": {
      "type": "object",
      "properties": {
        "additionalOrigins": {
          "type": "array",
          "uniqueItems": true,
          "items": {
            "type": "string"
          },
          "default": [],
          "title": "Additional Origins"
        }
      },
      "additionalProperties": false,
      "title": "Csrf"
    },
    "Policy2": {
      "type": "object",
      "properties": {
        "requestTimeout": {
          "type": [
            "string",
            "null"
          ],
          "title": "Request Timeout"
        },
        "backendRequestTimeout": {
          "type": [
            "string",
            "null"
          ],
          "title": "Backend Request Timeout"
        }
      },
      "additionalProperties": false,
      "title": "Policy2"
    },
    "Policy3": {
      "type": "object",
      "properties": {
        "attempts": {
          "type": "integer",
          "format": "uint8",
          "minimum": 1,
          "maximum": 255,
          "default": 1,
          "title": "Attempts"
        },
        "backoff": {
          "type": [
            "string",
            "null"
          ],
          "title": "Backoff"
        },
        "codes": {
          "type": "array",
          "items": {
            "type": "integer",
            "format": "uint16",
            "minimum": 1,
            "maximum": 65535
          },
          "title": "Codes"
        }
      },
      "additionalProperties": false,
      "required": [
        "codes"
      ],
      "title": "Policy3"
    }
  },
  "description": "Local Policy configuration"
}